# 受入基準テンプレート集

よくあるユーザーストーリーパターンに対応する受入基準のテンプレートです。これらをベースに、プロジェクト固有の要件をカスタマイズしてください。

## 目次

- [ユーザー認証](#ユーザー認証)
- [CRUD操作](#crud操作)
- [検索・フィルタリング](#検索フィルタリング)
- [フォームバリデーション](#フォームバリデーション)
- [支払い・決済](#支払い決済)
- [通知・アラート](#通知アラート)
- [ファイルアップロード](#ファイルアップロード)
- [アクセス制御・権限管理](#アクセス制御権限管理)
- [API連携](#api連携)
- [レポート・エクスポート](#レポートエクスポート)

---

## ユーザー認証

### ログイン機能

```gherkin
Feature: ユーザーログイン
  登録済みユーザーがメールアドレスとパスワードでログインできる

  Background:
    Given 以下のユーザーが登録されている
      | メールアドレス       | パスワード    | ステータス |
      | user@example.com     | SecurePass123 | アクティブ |
      | inactive@example.com | Password123   | 非アクティブ |

  Rule: 有効な認証情報でログインできる

    Example: 正しい認証情報でログイン
      Given ログイン画面を開いている
      When メールアドレス "user@example.com" を入力する
      And パスワード "SecurePass123" を入力する
      And ログインボタンをクリックする
      Then ダッシュボード画面に遷移する
      And ユーザー名 "user@example.com" が表示される

  Rule: 無効な認証情報ではログインできない

    Example: 誤ったパスワードでログインを試みる
      Given ログイン画面を開いている
      When メールアドレス "user@example.com" を入力する
      And パスワード "WrongPassword" を入力する
      And ログインボタンをクリックする
      Then エラーメッセージ "メールアドレスまたはパスワードが正しくありません" が表示される
      And ログイン画面に留まる

    Example: 存在しないメールアドレスでログインを試みる
      Given ログイン画面を開いている
      When メールアドレス "nonexistent@example.com" を入力する
      And パスワード "AnyPassword123" を入力する
      And ログインボタンをクリックする
      Then エラーメッセージ "メールアドレスまたはパスワードが正しくありません" が表示される

  Rule: 非アクティブユーザーはログインできない

    Example: 非アクティブアカウントでログインを試みる
      Given ログイン画面を開いている
      When メールアドレス "inactive@example.com" を入力する
      And パスワード "Password123" を入力する
      And ログインボタンをクリックする
      Then エラーメッセージ "このアカウントは無効化されています" が表示される
```

### パスワードリセット

```gherkin
Feature: パスワードリセット
  ユーザーがパスワードを忘れた場合、メールアドレスを使用してリセットできる

  Rule: 登録済みメールアドレスにリセットリンクが送信される

    Example: 有効なメールアドレスでリセットを要求
      Given パスワードリセット画面を開いている
      When メールアドレス "user@example.com" を入力する
      And リセット要求ボタンをクリックする
      Then 確認メッセージ "リセットリンクを送信しました" が表示される
      And "user@example.com" にリセットリンクが送信される

  Rule: リセットリンクは24時間有効

    Example: 有効期限内のリンクでパスワードをリセット
      Given リセットリンクをクリックして開いている
      And リンクの生成から12時間経過している
      When 新しいパスワード "NewSecurePass456" を入力する
      And パスワード確認 "NewSecurePass456" を入力する
      And リセットボタンをクリックする
      Then パスワードが更新される
      And ログイン画面に遷移する

    Example: 有効期限切れのリンクを使用
      Given リセットリンクをクリックして開いている
      And リンクの生成から25時間経過している
      Then エラーメッセージ "リセットリンクの有効期限が切れています" が表示される
```

---

## CRUD操作

### データ作成

```gherkin
Feature: タスク作成
  ユーザーが新しいタスクを作成できる

  Rule: 必須項目が入力されている場合、タスクを作成できる

    Example: 有効なタスクを作成
      Given タスク作成画面を開いている
      When タスク名 "プロジェクト企画書作成" を入力する
      And 期限 "2024-12-31" を選択する
      And 優先度 "高" を選択する
      And 保存ボタンをクリックする
      Then タスクが作成される
      And タスク一覧画面に遷移する
      And 作成したタスクが一覧に表示される

  Rule: 必須項目が未入力の場合、タスクを作成できない

    Example: タスク名が未入力
      Given タスク作成画面を開いている
      When 期限 "2024-12-31" を選択する
      And 保存ボタンをクリックする
      Then エラーメッセージ "タスク名は必須です" が表示される
      And タスクは作成されない
```

### データ更新

```gherkin
Feature: タスク編集
  ユーザーが既存のタスクを編集できる

  Background:
    Given 以下のタスクが存在する
      | ID | タスク名             | 期限       | 優先度 | ステータス |
      | 1  | プロジェクト企画書作成 | 2024-12-31 | 高     | 未着手     |

  Rule: タスクの内容を変更できる

    Example: タスク名と優先度を変更
      Given タスクID 1 の編集画面を開いている
      When タスク名を "プロジェクト企画書レビュー" に変更する
      And 優先度を "中" に変更する
      And 保存ボタンをクリックする
      Then タスクが更新される
      And 変更内容が反映される
```

### データ削除

```gherkin
Feature: タスク削除
  ユーザーが不要になったタスクを削除できる

  Background:
    Given 以下のタスクが存在する
      | ID | タスク名             | ステータス |
      | 1  | プロジェクト企画書作成 | 完了       |

  Rule: 確認ダイアログで承認した場合のみ削除される

    Example: 削除を確認して実行
      Given タスク一覧画面を開いている
      When タスクID 1 の削除ボタンをクリックする
      And 確認ダイアログで「削除」をクリックする
      Then タスクが削除される
      And タスク一覧からタスクID 1 が消える

    Example: 削除をキャンセル
      Given タスク一覧画面を開いている
      When タスクID 1 の削除ボタンをクリックする
      And 確認ダイアログで「キャンセル」をクリックする
      Then タスクは削除されない
      And タスク一覧にタスクID 1 が表示されたまま
```

---

## 検索・フィルタリング

```gherkin
Feature: 商品検索
  ユーザーがキーワードで商品を検索できる

  Background:
    Given 以下の商品が存在する
      | 商品名          | カテゴリ  | 価格    |
      | MacBook Pro     | PC        | 200,000 |
      | MacBook Air     | PC        | 150,000 |
      | iPad Pro        | タブレット | 100,000 |
      | Magic Keyboard  | アクセサリ | 20,000  |

  Rule: キーワードに部分一致する商品を表示

    Example: キーワード "MacBook" で検索
      Given 商品一覧画面を開いている
      When 検索キーワード "MacBook" を入力する
      And 検索ボタンをクリックする
      Then 以下の商品が表示される
        | 商品名      |
        | MacBook Pro |
        | MacBook Air |

    Example: キーワード "iPad" で検索
      Given 商品一覧画面を開いている
      When 検索キーワード "iPad" を入力する
      And 検索ボタンをクリックする
      Then 商品 "iPad Pro" のみが表示される

  Rule: 検索結果が0件の場合、メッセージを表示

    Example: 存在しない商品名で検索
      Given 商品一覧画面を開いている
      When 検索キーワード "Surface" を入力する
      And 検索ボタンをクリックする
      Then メッセージ "検索結果が見つかりませんでした" が表示される
      And 代替提案として人気商品が表示される

  Rule: カテゴリとキーワードを組み合わせて検索できる

    Example: カテゴリ "PC" + キーワード "Air"
      Given 商品一覧画面を開いている
      When カテゴリ "PC" を選択する
      And 検索キーワード "Air" を入力する
      And 検索ボタンをクリックする
      Then 商品 "MacBook Air" のみが表示される
```

---

## フォームバリデーション

```gherkin
Feature: ユーザー登録フォーム
  新規ユーザーがアカウントを作成できる

  Rule: メールアドレスは正しい形式である必要がある

    Scenario Outline: メールアドレスの形式チェック
      Given ユーザー登録画面を開いている
      When メールアドレス "<email>" を入力する
      And 次へボタンをクリックする
      Then 結果は "<result>" となる

      Examples:
        | email               | result           |
        | user@example.com    | 成功             |
        | user.name@co.jp     | 成功             |
        | invalid-email       | エラー表示       |
        | @example.com        | エラー表示       |
        | user@               | エラー表示       |

  Rule: パスワードは8文字以上かつ英数字を含む必要がある

    Scenario Outline: パスワードの強度チェック
      Given ユーザー登録画面を開いている
      When パスワード "<password>" を入力する
      Then パスワード強度は "<strength>" と表示される

      Examples:
        | password       | strength |
        | SecurePass123  | 強       |
        | Pass123        | 弱       |
        | 12345678       | 無効     |
        | PasswordOnly   | 無効     |
        | Short1         | 無効     |
```

---

## 支払い・決済

```gherkin
Feature: クレジットカード決済
  ユーザーがクレジットカードで商品を購入できる

  Background:
    Given 以下の商品がカートに入っている
      | 商品名      | 価格    | 数量 |
      | MacBook Pro | 200,000 | 1    |

  Rule: 有効なクレジットカード情報で決済できる

    Example: 決済成功
      Given 決済画面を開いている
      When 以下のカード情報を入力する
        | カード番号          | 4111111111111111 |
        | 有効期限            | 12/25            |
        | セキュリティコード  | 123              |
      And 決済ボタンをクリックする
      Then 決済が完了する
      And 注文確認メールが送信される
      And 注文履歴に記録される

  Rule: カード情報が無効な場合、決済できない

    Example: 有効期限切れのカード
      Given 決済画面を開いている
      When 以下のカード情報を入力する
        | カード番号          | 4111111111111111 |
        | 有効期限            | 12/20            |
        | セキュリティコード  | 123              |
      And 決済ボタンをクリックする
      Then エラーメッセージ "カードの有効期限が切れています" が表示される
      And 決済は実行されない

  Rule: 決済失敗時はリトライ可能

    Example: ネットワークエラーで決済失敗
      Given 決済画面を開いている
      And ネットワークエラーが発生する状況
      When 決済ボタンをクリックする
      Then エラーメッセージ "決済処理に失敗しました。もう一度お試しください" が表示される
      And 再試行ボタンが表示される
```

---

## 通知・アラート

```gherkin
Feature: タスク期限通知
  ユーザーにタスクの期限が近づいていることを通知する

  Background:
    Given 現在日時は 2024-01-10 09:00 である
    And 以下のタスクが存在する
      | タスク名    | 期限             | 通知設定     |
      | タスクA     | 2024-01-10 17:00 | 当日に通知   |
      | タスクB     | 2024-01-11 17:00 | 1日前に通知  |
      | タスクC     | 2024-01-15 17:00 | 通知なし     |

  Rule: 期限当日の朝9時に通知を送信

    Example: 当日期限のタスク通知
      When 通知バッチ処理が実行される
      Then ユーザーに以下の通知が送信される
        | タスク名 | メッセージ                           |
        | タスクA  | タスクAの期限は本日17:00です         |

  Rule: 期限1日前の朝9時に通知を送信

    Example: 翌日期限のタスク通知
      When 通知バッチ処理が実行される
      Then ユーザーに以下の通知が送信される
        | タスク名 | メッセージ                           |
        | タスクB  | タスクBの期限は明日17:00です         |

  Rule: 通知設定が「なし」の場合は通知しない

    Example: 通知なし設定のタスク
      When 通知バッチ処理が実行される
      Then タスクCに関する通知は送信されない
```

---

## ファイルアップロード

```gherkin
Feature: プロフィール画像アップロード
  ユーザーがプロフィール画像をアップロードできる

  Rule: JPEG, PNG形式で5MB以下のファイルをアップロード可能

    Scenario Outline: ファイル形式とサイズのチェック
      Given プロフィール編集画面を開いている
      When "<filename>" をアップロードする
      Then 結果は "<result>" となる

      Examples:
        | filename           | result           |
        | profile.jpg (2MB)  | 成功             |
        | profile.png (4MB)  | 成功             |
        | profile.gif (1MB)  | エラー（形式）   |
        | profile.jpg (6MB)  | エラー（サイズ） |

  Rule: アップロード後、画像プレビューを表示

    Example: 画像アップロード成功
      Given プロフィール編集画面を開いている
      When "profile.jpg" をアップロードする
      Then アップロードが成功する
      And プレビュー画像が表示される
      And 保存ボタンが有効になる
```

---

## アクセス制御・権限管理

```gherkin
Feature: ドキュメント管理
  ユーザーの役割に応じてドキュメントへのアクセスを制御する

  Background:
    Given 以下のユーザーが存在する
      | ユーザー名 | 役割     |
      | Alice      | 管理者   |
      | Bob        | 編集者   |
      | Carol      | 閲覧者   |
    And ドキュメント "プロジェクト計画書" が存在する

  Rule: 管理者は全ての操作が可能

    Example: 管理者がドキュメントを削除
      Given Alice がログインしている
      When ドキュメント "プロジェクト計画書" を削除する
      Then ドキュメントが削除される

  Rule: 編集者は閲覧と編集が可能、削除は不可

    Example: 編集者がドキュメントを編集
      Given Bob がログインしている
      When ドキュメント "プロジェクト計画書" を編集する
      Then 編集内容が保存される

    Example: 編集者がドキュメント削除を試みる
      Given Bob がログインしている
      When ドキュメント "プロジェクト計画書" を削除しようとする
      Then エラーメッセージ "削除権限がありません" が表示される

  Rule: 閲覧者は閲覧のみ可能

    Example: 閲覧者がドキュメントを閲覧
      Given Carol がログインしている
      When ドキュメント "プロジェクト計画書" を開く
      Then ドキュメント内容が表示される
      And 編集ボタンは表示されない
```

---

## API連携

```gherkin
Feature: 外部天気API連携
  外部APIから天気情報を取得して表示する

  Rule: API呼び出しが成功した場合、天気情報を表示

    Example: 東京の天気を取得
      Given ダッシュボード画面を開いている
      When 天気ウィジェットが読み込まれる
      And 外部APIが以下のレスポンスを返す
        """
        {
          "location": "東京",
          "weather": "晴れ",
          "temperature": 25
        }
        """
      Then 天気情報 "晴れ 25°C" が表示される

  Rule: API呼び出しが失敗した場合、エラーメッセージを表示

    Example: APIタイムアウト
      Given ダッシュボード画面を開いている
      When 天気ウィジェットが読み込まれる
      And 外部APIがタイムアウトする
      Then エラーメッセージ "天気情報を取得できませんでした" が表示される
      And 再試行ボタンが表示される

  Rule: APIレート制限に達した場合、キャッシュデータを表示

    Example: レート制限超過
      Given ダッシュボード画面を開いている
      And APIの1時間あたりの呼び出し上限に達している
      And 30分前のキャッシュデータが存在する
      When 天気ウィジェットが読み込まれる
      Then キャッシュされた天気情報が表示される
      And 「30分前のデータ」と表示される
```

---

## レポート・エクスポート

```gherkin
Feature: 売上レポート出力
  ユーザーが売上データをCSV形式でエクスポートできる

  Background:
    Given 以下の売上データが存在する
      | 日付       | 商品     | 金額   |
      | 2024-01-01 | 商品A    | 10,000 |
      | 2024-01-02 | 商品B    | 20,000 |
      | 2024-01-03 | 商品A    | 15,000 |

  Rule: 期間を指定してデータをエクスポートできる

    Example: 2024年1月1日-1月2日のデータをエクスポート
      Given レポート画面を開いている
      When 開始日 "2024-01-01" を選択する
      And 終了日 "2024-01-02" を選択する
      And エクスポートボタンをクリックする
      Then CSVファイル "sales_20240101_20240102.csv" がダウンロードされる
      And CSVには以下のデータが含まれる
        """
        日付,商品,金額
        2024-01-01,商品A,10000
        2024-01-02,商品B,20000
        """

  Rule: データが0件の場合、空のCSVをエクスポート

    Example: データが存在しない期間を指定
      Given レポート画面を開いている
      When 開始日 "2024-01-10" を選択する
      And 終了日 "2024-01-15" を選択する
      And エクスポートボタンをクリックする
      Then CSVファイル "sales_20240110_20240115.csv" がダウンロードされる
      And CSVにはヘッダー行のみが含まれる
```

---

## カスタマイズのガイドライン

これらのテンプレートを使用する際は:

1. **プロジェクト固有の用語に置き換える**
   - 「ユーザー」→ 「会員」「顧客」など
   - 「タスク」→ 「チケット」「案件」など

2. **ビジネスルールを追加する**
   - 業界特有の規制
   - 社内ポリシー
   - 法的要件

3. **非機能要件を含める**
   - パフォーマンス（「検索は3秒以内に完了する」）
   - アクセシビリティ（「スクリーンリーダー対応」）
   - セキュリティ（「通信はHTTPSで暗号化」）

4. **実際のデータ例を使用する**
   - テスト用の実データに近い値
   - エッジケースを網羅する境界値

---

*これらのテンプレートは出発点です。Example Mappingセッションを通じて、プロジェクト固有の受入基準に発展させてください。*
