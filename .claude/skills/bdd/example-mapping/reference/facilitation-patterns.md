# Example Mapping Facilitation Patterns

## 3 Amigos Perspectives

Example Mappingセッションでは、3つの異なる視点から質問・検証を行います。

### 開発者 (Developer) の視点

**関心事:**
- 技術的実現可能性
- 実装の複雑さ
- 既存システムとの整合性
- 境界値・エッジケース

**典型的な質問:**
```
「この条件判定のロジックは複雑すぎませんか?」
「境界値のテストケースを追加しましょう」
「このルールは既存のXX機能と矛盾しませんか?」
「この処理のパフォーマンス要件は?」
「エラーハンドリングはどうしますか?」
「依存する外部システムは?」
```

**レビューポイント:**
- [ ] 実装可能な粒度に分解されているか
- [ ] 技術的な制約・依存関係が明確か
- [ ] エッジケースがカバーされているか
- [ ] 既存機能との整合性が取れているか

### テスター (Tester) の視点

**関心事:**
- テストカバレッジ
- 品質保証
- エラーケース・異常系
- 自動テスト可能性

**典型的な質問:**
```
「エッジケースは網羅されていますか?」
「エラー時の振る舞いを明確にしましょう」
「このシナリオは自動テスト可能ですか?」
「境界値のテストは必要ですか?」
「セキュリティ観点で懸念点は?」
「パフォーマンステストは?」
```

**レビューポイント:**
- [ ] 正常系・異常系の両方がカバーされているか
- [ ] 境界値が明確か
- [ ] テストデータが具体的か
- [ ] 検証可能な期待結果が定義されているか

### プロダクトオーナー (PO) の視点

**関心事:**
- ビジネス価値
- ユーザー体験
- スコープと優先度
- MVP定義

**典型的な質問:**
```
「このルールのビジネス価値は何ですか?」
「ユーザーにとって最も重要なシナリオはどれですか?」
「MVPに含める最小限のルールは何でしょうか?」
「このルールは本当に必要ですか?」
「ユーザーはこの機能をどう使いますか?」
「成功をどう測定しますか?」
```

**レビューポイント:**
- [ ] ビジネス価値が明確か
- [ ] ユーザーストーリーと整合しているか
- [ ] 優先度が適切か
- [ ] スコープが明確か

## Question Patterns by Phase

### Phase 2: ルール抽出の質問パターン

#### 発見的質問
```
「この機能で守るべきビジネスルールは何ですか?」
「どんな条件下でこの機能は動作すべきですか?」
「禁止事項や制約条件はありますか?」
「どんな場合に機能が失敗すべきですか?」
「特別扱いすべきケースはありますか?」
```

#### 明確化質問
```
「『〇〇の場合』とは、具体的にどういう状況ですか?」
「この条件は必須ですか、それとも任意ですか?」
「『適切に』『正しく』とは具体的にどういう状態ですか?」
「この用語の正確な定義は?」
```

#### 境界値質問
```
「最小値・最大値はありますか?」
「空の場合、ゼロの場合はどうなりますか?」
「エラー時の振る舞いは定義されていますか?」
「NULL、空文字、スペースのみの場合は?」
「上限を超えた場合の動作は?」
```

### Phase 3: 具体例作成の質問パターン

#### シンプルケース発見
```
「このルールを説明する最もシンプルな例は何ですか?」
「このルールが適用される典型的なケースを教えてください」
「ハッピーパスの例を1つ挙げてください」
```

#### エッジケース発見
```
「このルールが適用されない境界ケースはありますか?」
「例外的なケースは?」
「0件、1件、多数の場合で動作は変わりますか?」
「同時実行時の動作は?」
```

#### 検証可能性確認
```
「この例は自動テスト可能ですか?」
「期待結果は明確ですか?」
「テストデータは用意できますか?」
「前提条件は再現可能ですか?」
```

## Facilitation Techniques

### タイムボックス管理

```
00:00-05:00  Phase 1: ストーリーカードの作成
             → 5分経過時に強制的に次へ

05:00-15:00  Phase 2: ルールカードの抽出
             → 10分時点でルール数確認
             → 5個以上なら分割検討

15:00-23:00  Phase 3: 具体例カードの作成
             → 各ルールに最低1例あるか確認

23:00-25:00  Phase 4: 質問整理と次アクション
```

**タイムボックスを守るコツ:**
- タイマーを見える位置に配置
- 5分前に進捗確認
- 完璧を求めない
- 議論が長引いたら赤カードに記録して次へ

### 赤カード (質問) の活用

**赤カードを出すタイミング:**
```
「この点、今は決められないので赤カードに記録しましょう」
「詳細は後で確認が必要ですね。赤カードに追加します」
「技術的な検討が必要です。赤カードにして次に進みましょう」
```

**赤カードの分類:**
- 🔴 Blocker: 実装前に解決必須
- 🟡 Clarification: 明確化により品質向上
- 🟢 Future: 将来的に検討

### ストーリー分割の判断

**25分で終わらない場合:**
```
Claude: 「25分が経過しましたが、まだルールが3つしか定義されていません。
        このストーリーは大きすぎる可能性があります。
        以下のどれかを選択しましょう:

        A) 最も重要なルール2-3個に絞って、残りは別ストーリーに
        B) ユーザーストーリーを2つに分割
        C) より詳細な情報を得るため、別途セッションを設定

        どれが適切だと思いますか?」
```

**分割の兆候:**
- ルールが7個以上
- 各ルールに5個以上の例が必要
- 赤カードが10個以上
- 異なるユーザーペルソナが混在

## Conversation Flow Templates

### セッション開始

```
Claude: 「Example Mappingセッションを開始します。
        タイムボックスは25分です。

        まず、このストーリーを『誰が、何を、なぜ』の形で
        確認させてください。」
```

### ルール抽出フェーズ

```
Claude: 「このストーリーで守るべきビジネスルールを
        洗い出しましょう。

        まず、最も重要なルールは何でしょうか?」

→ ルール1を記録

Claude: 「他にルールはありますか?
        特に、エラーケースや制約条件について
        考えてみてください。」
```

### 具体例作成フェーズ

```
Claude: 「ルール1について、最もシンプルな例を
        教えてください。」

→ Example 1.1を記録

Claude: 「このルールが適用されない境界ケースは
        ありますか?」

→ Example 1.2 (エッジケース) を記録
```

### セッション終了

```
Claude: 「25分が経過しました。成果を確認します:

        📄 ストーリー: 1個
        📘 ルール: 4個
        📗 具体例: 12個
        📕 質問: 3個

        次のアクション:
        - 🔴ブロッカー質問2個をPOに確認
        - Gherkin形式への変換
        - 実装タスクの作成

        よろしいですか?」
```

## Anti-Patterns to Avoid

### ❌ 実装の議論に脱線
```
Bad: 「このAPIはRESTかGraphQLか?」
     → 技術的な実装の詳細

Good: 「外部システムとの連携が必要」
      → 赤カードに記録して次へ
```

### ❌ 完璧主義
```
Bad: 「すべてのエッジケースを今洗い出さないと」
     → タイムボックス超過

Good: 「主要なケースは3つ。残りは赤カードで記録」
      → 重要なものに集中
```

### ❌ 一人で完結
```
Bad: Claude が一方的にルールを列挙
     → 対話がない

Good: 「他にルールはありますか?」
      → ユーザーに考えてもらう
```

### ❌ 曖昧さを放置
```
Bad: 「適切に処理する」→ 曖昧なまま進める

Good: 「『適切に』とは具体的に?」
      → 明確化または赤カード化
```
